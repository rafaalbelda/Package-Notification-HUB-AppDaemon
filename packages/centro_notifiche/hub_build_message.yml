>-
  {# ** DO NOT REMOVE THE SYMBOL " > " ABOVE ***** #}
  {# ********************************************* #}
  {#             MACROS AND SETTINGS               #}
  {# ********************************************* #}

  {% set nome = states('sensor.notifier_config') | default('Centro Notifiche') %}
    {% if nome | length == 0 %}
      {% set nome = 'Hassio' %}
    {% endif %}

  {%- macro annuncio() -%}
    {% if now().hour < 12 and now().hour > 6 %}
      {% set annuncio = ["Buen día. ", "Buenos días. "] %}
    {% elif now().hour >= 12 and now().hour < 17 %}
      {% set annuncio = ["Buenas tardes. ", "Buenas. "] %}
    {% else %}
      {% set annuncio = ["Buenas noches. "] %}
    {% endif %}
    {{ annuncio|random }}
  {%- endmacro -%}

  {%- macro modo_ospite() -%}
    {% if is_state ('input_boolean.notifier_guest_mode', 'on') %}
      {% set modo_ospite = [
        "Parece que tenemos un invitado en la casa.. ",
        "Tenemos un invitado. Voy a activar el modo invitado.. ",
        "Activé el modo invitado para la visita de nuestra casa.. ",
        "Paso al modo invitado. ",
        "No es frecuente que tengamos invitados, déjame preparar la casa para tu visita.. "
      ] %}
    {% else %}
      {% set modo_ospite = [
        "Parece que nuestro invitado se ha ido, desactivaré el modo invitado.. ",
        "Déjame desactivar el modo invitado ya que no hay más invitados.. ",
        "Desactivé el modo invitado y reanudé las operaciones normales.. ",
        "Desactivo el modo invitado. ",
        "Como no hay más invitados me permito desactivar el modo invitado. "
      ] %}
    {% endif %}
    {{ modo_ospite|random }}
  {%- endmacro -%}


  {# *************************************************************************** #}
  {#        SEQUENTIAL START OF THE CONSTRUCTION OF THE MESSAGE / NEWS           #}
  {# *************************************************************************** #}
  {% if not call_no_annuncio|default %} {{ annuncio() }} {% endif %}
  {% if call_modo_ospite|default %} {{ modo_ospite() }} {% endif %}

  {# Example of how to add more variables - Call from Welcome Automation #}
  {{ benvenuto|default }}

  {# + Message content passed through automations/scripts + #}
  {{ message|default }}
